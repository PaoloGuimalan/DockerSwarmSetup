version: "3.8"
services:
  chatterloop-post-scores-cron:
    image: johnpauloramil187/chatterloop_cron_service:latest
    build: .
    deploy:
      replicas: 1
      restart_policy:
        condition: any
        delay: 5s
        max_attempts: 3
    networks:
      - traefik-public
    healthcheck:
      test:
        [
          "CMD",
          "pg_isready",
          "-U",
          "${DB_USER}",
          "-h",
          "${DB_HOST}",
          "-p",
          "${DB_PORT}",
        ]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "5"

networks:
  traefik-public:
    external: true
    name: traefik-public
